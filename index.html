<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>New Brick - Web Version</title>
    <link rel="stylesheet" href="style.css">
    <!-- PixiJS -->
    <script src="https://cdn.jsdelivr.net/npm/pixi.js@8.6.6/dist/pixi.min.js"></script>
    <!-- Matter.js -->
    <script src="https://cdn.jsdelivr.net/npm/matter-js@0.19.0/build/matter.min.js"></script>
</head>

<body>
    <div id="game-container">
        <div id="ui-layer">
            <div id="score-board">COMBO: <span id="combo-count">0</span></div>
            <div id="height-board">HEIGHT: <span id="height-value">0</span>m</div>
            <div id="fever-indicator" class="hidden">FEVER!</div>
        </div>
        <canvas id="game-canvas"></canvas>
    </div>

    <!-- 모든 로직을 하나의 파일로 합치거나 순서를 엄격히 제어 -->
    <script src="src/constants.js"></script>
    <script src="src/audio.js"></script>
    <script src="src/effects.js"></script>
    <script src="src/board.js"></script>
    <script src="src/ball.js"></script>
    <script src="src/game.js"></script>

    <script>
        // 디버깅용: 로드 확인
        console.log("PIXI:", typeof PIXI);
        console.log("Matter:", typeof Matter);

        window.addEventListener('error', function (e) {
            console.error("Runtime Error:", e.error);
            // 화면에 에러 표시
            const errDiv = document.createElement('div');
            errDiv.style.position = 'absolute';
            errDiv.style.top = '50%';
            errDiv.style.left = '50%';
            errDiv.style.transform = 'translate(-50%, -50%)';
            errDiv.style.background = 'rgba(255, 0, 0, 0.9)';
            errDiv.style.color = 'white';
            errDiv.style.padding = '20px';
            errDiv.style.zIndex = '9999';
            errDiv.innerHTML = `
                <h3 style="margin-bottom:10px">ERROR!</h3>
                <p><strong>Message:</strong> ${e.message}</p>
                <p><strong>File:</strong> ${e.filename}</p>
                <p><strong>Line:</strong> ${e.lineno}:${e.colno}</p>
            `;
            document.body.appendChild(errDiv);
        });
    </script>
</body>

</html>